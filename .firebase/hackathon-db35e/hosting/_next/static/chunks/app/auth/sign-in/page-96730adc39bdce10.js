(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[697],{45477:function(e,t,r){Promise.resolve().then(r.bind(r,25218)),Promise.resolve().then(r.bind(r,5415)),Promise.resolve().then(r.bind(r,82591)),Promise.resolve().then(r.t.bind(r,231,23)),Promise.resolve().then(r.bind(r,15821)),Promise.resolve().then(r.bind(r,73138)),Promise.resolve().then(r.bind(r,80508))},15821:function(e,t,r){"use strict";r.d(t,{GuestGuard:function(){return d}});var n=r(57437),s=r(2265),o=r(16463),i=r(80162),a=r(85240),l=r(48727),u=r(68692);function d(e){let{children:t}=e,r=(0,o.useRouter)(),{user:d,error:c,isLoading:g}=(0,u.a)(),[h,m]=s.useState(!0),f=async()=>{if(!g){if(c){m(!1);return}if(d){l.k.debug("[GuestGuard]: User is logged in, redirecting to dashboard"),r.replace(a.H.dashboard.Analiza);return}m(!1)}};return(s.useEffect(()=>{f().catch(()=>{})},[d,c,g]),h)?null:c?(0,n.jsx)(i.Z,{color:"error",children:c}):(0,n.jsx)(s.Fragment,{children:t})}},73138:function(e,t,r){"use strict";r.d(t,{SignInForm:function(){return _}});var n=r(57437),s=r(2265),o=r(87138),i=r(16463),a=r(31014),l=r(80162),u=r(75519),d=r(28549),c=r(10437),g=r(56065),h=r(41665),m=r(55677),f=r(88929),v=r(83719),p=r(75830),w=r(49959),b=r(39343),S=r(59772),x=r(85240),k=r(93814),I=r(68692);let U=S.z.object({email:S.z.string().min(1,{message:"Login is required"}),password:S.z.string().min(1,{message:"Password is required"})});localStorage.getItem("id");let j=localStorage.getItem("login"),y=localStorage.getItem("password"),L={email:"string"==typeof j?j:"",password:"string"==typeof y?y:""};function _(){let e=(0,i.useRouter)(),{checkSession:t}=(0,I.a)(),[r,S]=s.useState(),[j,y]=s.useState(!1),{control:_,handleSubmit:R,setError:P,formState:{errors:E}}=(0,b.cI)({defaultValues:L,resolver:(0,a.F)(U)}),Z=s.useCallback(async r=>{y(!0);let{error:n}=await k.U.signInWithPassword(r);if(n){P("root",{type:"server",message:n}),y(!1);return}await (null==t?void 0:t()),e.refresh()},[t,e,P]);return(0,n.jsxs)(f.Z,{spacing:4,children:[(0,n.jsxs)(f.Z,{spacing:1,children:[(0,n.jsx)(v.Z,{variant:"h4",children:"Sign in"}),(0,n.jsxs)(v.Z,{color:"text.secondary",variant:"body2",children:["Don't have an account?"," ",(0,n.jsx)(h.Z,{component:o.default,href:x.H.auth.signUp,underline:"hover",variant:"subtitle2",children:"Sign up"})]})]}),(0,n.jsx)("form",{onSubmit:R(Z),children:(0,n.jsxs)(f.Z,{spacing:2,children:[(0,n.jsx)(b.Qr,{control:_,name:"email",render:e=>{let{field:t}=e;return(0,n.jsxs)(d.Z,{error:!!E.email,children:[(0,n.jsx)(g.Z,{children:"Login"}),(0,n.jsx)(m.Z,{...t,label:"Login",type:"text"}),E.email?(0,n.jsx)(c.Z,{children:E.email.message}):null]})}}),(0,n.jsx)(b.Qr,{control:_,name:"password",render:e=>{let{field:t}=e;return(0,n.jsxs)(d.Z,{error:!!E.password,children:[(0,n.jsx)(g.Z,{children:"Password"}),(0,n.jsx)(m.Z,{...t,endAdornment:r?(0,n.jsx)(p.b,{cursor:"pointer",fontSize:"var(--icon-fontSize-md)",onClick:()=>{S(!1)}}):(0,n.jsx)(w.N,{cursor:"pointer",fontSize:"var(--icon-fontSize-md)",onClick:()=>{S(!0)}}),label:"Password",type:r?"text":"password"}),E.password?(0,n.jsx)(c.Z,{children:E.password.message}):null]})}}),(0,n.jsx)("div",{children:(0,n.jsx)(h.Z,{component:o.default,href:x.H.auth.resetPassword,variant:"subtitle2",children:"Forgot password?"})}),E.root?(0,n.jsx)(l.Z,{color:"error",children:E.root.message}):null,(0,n.jsx)(u.Z,{disabled:j,type:"submit",variant:"contained",children:"Sign in"})]})})]})}},80508:function(e,t,r){"use strict";r.d(t,{DynamicLogo:function(){return d},T:function(){return u}});var n=r(57437),s=r(2265),o=r(7999),i=r(98598),a=r(38017);function l(e){let{children:t,defer:r=!1,fallback:o=null}=e,[i,l]=s.useState(!1);return(0,a.Z)(()=>{r||l(!0)},[r]),s.useEffect(()=>{r&&l(!0)},[r]),(0,n.jsx)(s.Fragment,{children:i?t:o})}function u(e){let t,{color:r="dark",emblem:s,height:i=60,width:a=60}=e;return t=s?"light"===r?"/assets/logo-emblem.svg":"/assets/logo-emblem--dark.svg":"light"===r?"/assets/logo.svg":"/assets/logo--dark.svg",(0,n.jsx)(o.Z,{alt:"logo",component:"img",height:i,src:t,width:a})}function d(e){let{colorDark:t="light",colorLight:r="dark",height:s=60,width:a=60,...d}=e,{colorScheme:c}=(0,i.tv)();return(0,n.jsx)(l,{fallback:(0,n.jsx)(o.Z,{sx:{height:"".concat(s,"px"),width:"".concat(a,"px")}}),children:(0,n.jsx)(u,{color:"dark"===c?t:r,height:s,width:a,...d})})}},22298:function(e,t,r){"use strict";r.d(t,{S:function(){return a},UserProvider:function(){return l}});var n=r(57437),s=r(2265),o=r(93814),i=r(48727);let a=s.createContext(void 0);function l(e){let{children:t}=e,[r,l]=s.useState({user:null,error:null,isLoading:!0}),u=s.useCallback(async()=>{try{let{data:e,error:t}=await o.U.getUser();if(t){i.k.error(t),l(e=>({...e,user:null,error:"Something went wrong",isLoading:!1}));return}l(t=>({...t,user:null!=e?e:null,error:null,isLoading:!1}))}catch(e){i.k.error(e),l(e=>({...e,user:null,error:"Something went wrong",isLoading:!1}))}},[]);return s.useEffect(()=>{u().catch(e=>{i.k.error(e)})},[]),(0,n.jsx)(a.Provider,{value:{...r,checkSession:u},children:t})}a.Consumer},88674:function(e,t,r){"use strict";var n=r(33128),s=r(69355),o=r(93935),i=r(41287),a=r(98163),l=r(26175);r(75931);var u=r(20084);let d=new n.u({uri:"https://hackathonapi.onrender.com/"}),c=new a.g((0,l.eI)({url:"ws://hackathonapi.onrender.com"})),g=(0,s.V)(e=>{let{query:t}=e,r=(0,u.p$)(t);return"OperationDefinition"===r.kind&&"subscription"===r.operation},c,d),h=new o.f({link:g,cache:new i.h,connectToDevTools:!0});t.Z=h},68692:function(e,t,r){"use strict";r.d(t,{a:function(){return o}});var n=r(2265),s=r(22298);function o(){let e=n.useContext(s.S);if(!e)throw Error("useUser must be used within a UserProvider");return e}},93814:function(e,t,r){"use strict";r.d(t,{U:function(){return m}});var n=r(48646),s=r(88674),o=r(21432);function i(){let e=(0,n._)(["query GetUsers($login: StringFilter) {\n          getUsers(login: $login) {\n            id\n            login\n            password  \n          }\n        }"]);return i=function(){return e},e}function a(){let e=(0,n._)(["query GetUsers {\n          getUsers {\n            id\n            login\n            password  \n          }\n        }"]);return a=function(){return e},e}function l(){let e=(0,n._)(["mutation InsertUsers($login: String, $password: String, $token: String) {\n        insertUsers(login: $login, password: $password, session_token: $token) {\n        id  \n        }\n      }"]);return l=function(){return e},e}function u(){let e=(0,n._)(["\n      mutation InsertUserInfo($roleId: Int, $userId: Int) {\n        insertUserInfo(roleId: $roleId, userId: $userId) {\n          id\n        }\n      }\n      "]);return u=function(){return e},e}function d(){let e=(0,n._)(["query GetUsers($login: StringFilter, $password: StringFilter) {\n          getUsers(login: $login, password: $password) {\n            id\n            login\n            password\n            session_token  \n          }\n        }"]);return d=function(){return e},e}function c(){let e=new Uint8Array(12);return window.crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}let g={id:"USR-000",avatar:"/assets/avatar.png",firstName:"Sofia",lastName:"Rivers",email:"sofia@devias.io"};class h{async signUp(e){let{email:t,password:r}=e,n=c();if(localStorage.setItem("custom-auth-token",n),0!==(await s.Z.query({query:(0,o.Ps)(i()),variables:{login:{value:t,filter:"eq"}}})).data.getUsers.length)return{error:"user already exists!"};let d=await s.Z.query({query:(0,o.Ps)(a())}),g=c();return await s.Z.mutate({mutation:(0,o.Ps)(l()),variables:{login:t,password:r,token:g}}),await s.Z.mutate({mutation:(0,o.Ps)(u()),variables:{roleId:1,userId:d.data.getUsers[d.data.getUsers.length-1].id+1}}),localStorage.setItem("session_token",g),localStorage.setItem("id",d.data.getUsers[d.data.getUsers.length-1].id+1),{}}async signInWithOAuth(e){return{error:"Social authentication not implemented"}}async signInWithPassword(e){let{email:t,password:r}=e,n=(await s.Z.query({query:(0,o.Ps)(d()),variables:{login:{value:t,filter:"eq"},password:{value:r,filter:"eq"}}})).data.getUsers;if(0===n.length)return{error:"Invalid credentials"};{let e=c();return localStorage.setItem("custom-auth-token",e),localStorage.setItem("id",n[0].id),localStorage.setItem("session_token",n[0].session_token),{}}}async resetPassword(e){return{error:"Password reset not implemented"}}async updatePassword(e){return{error:"Update reset not implemented"}}async getUser(){return localStorage.getItem("custom-auth-token")?{data:g}:{data:null}}async signOut(){return localStorage.removeItem("login"),localStorage.removeItem("password"),localStorage.removeItem("id"),localStorage.removeItem("custom-auth-token"),localStorage.removeItem("session_token"),{}}}let m=new h},48727:function(e,t,r){"use strict";let n;r.d(t,{k:function(){return g}});var s,o,i,a=r(20357);let l={ERROR:"ERROR",WARN:"WARN",DEBUG:"DEBUG",ALL:"ALL"},u={NONE:0,ERROR:1,WARN:2,DEBUG:3,ALL:4};class d{canWrite(e){return this.levelNumber>=u[e]}write(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];let s=this.prefix;this.showLevel&&(s="- ".concat(e," ").concat(s)),e===l.ERROR?console.error(s,...r):console.log(s,...r)}constructor({prefix:e="",level:t=l.ALL,showLevel:r=!0}){var n=this;this.debug=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];n.canWrite(l.DEBUG)&&n.write(l.DEBUG,...t)},this.warn=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];n.canWrite(l.WARN)&&n.write(l.WARN,...t)},this.error=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];n.canWrite(l.ERROR)&&n.write(l.ERROR,...t)},this.prefix=e,this.level=t,this.levelNumber=u[this.level],this.showLevel=r}}var c=r(20357);let g=function(){let{prefix:e,level:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new d({prefix:e,level:t})}({level:{site:{name:"Devias Kit",description:"",themeColor:"#090a0b",url:n=(n=(n=null!==(o=null!==(s=a.env.NEXT_PUBLIC_SITE_URL)&&void 0!==s?s:a.env.NEXT_PUBLIC_VERCEL_URL)&&void 0!==o?o:"http://localhost:3000/").includes("http")?n:"https://".concat(n)).endsWith("/")?n:"".concat(n,"/")},logLevel:null!==(i=c.env.NEXT_PUBLIC_LOG_LEVEL)&&void 0!==i?i:l.ALL}.logLevel})},85240:function(e,t,r){"use strict";r.d(t,{H:function(){return n}});let n={home:"/",auth:{signIn:"/auth/sign-in",signUp:"/auth/sign-up",resetPassword:"/auth/reset-password"},dashboard:{account:"/dashboard/account",customers:"/dashboard/customers",integrations:"/dashboard/integrations",settings:"/dashboard/settings",Analiza:"/dashboard/Analiza",Kalendarz:"/dashboard/Kalendarz",Lista_szkolen:"/dashboard/Lista_szkolen",Dodaj_szkolenie:"/dashboard/Dodaj_szkolenie",Dodaj_ankiete:"/dashboard/Dodaj_ankiete"},errors:{notFound:"/errors/not-found"}}}},function(e){e.O(0,[2957,9989,8466,9492,6175,3079,5677,6087,4171,1274,8165,1461,5947,2971,7023,1744],function(){return e(e.s=45477)}),_N_E=e.O()}]);